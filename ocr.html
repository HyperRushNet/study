<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>OCR AI Base64 Demo</title>
</head>
<body>
<h2>OCR AI Demo</h2>

<input type="file" id="imageInput" accept="image/*"><br>
<button id="scanBtn">Scan Image</button>

<h3>OCR Output:</h3>
<div id="output" style="white-space: pre-wrap; border:1px solid #ccc; padding:10px;"></div>

<script src="https://hyperrushnet.github.io/study/js/ocr.js?v=1.637830"></script>

<script>
const imageInput = document.getElementById("imageInput");
const scanBtn = document.getElementById("scanBtn");
const outputDiv = document.getElementById("output");

function fileToBase64(file) {
  return new Promise((resolve, reject) => {
    const reader = new FileReader();
    reader.onload = () => resolve(reader.result.split(',')[1]);
    reader.onerror = reject;
    reader.readAsDataURL(file);
  });
}

// Decode Base64 and display exact structure
function displayBase64Text(base64Text) {
  try {
    const decoded = decodeURIComponent(escape(atob(base64Text)));
    outputDiv.textContent = decoded;
  } catch (err) {
    outputDiv.textContent = "Error decoding: " + err;
  }
}

scanBtn.addEventListener("click", async () => {
  const file = imageInput.files[0];
  if (!file) return alert("Please upload an image.");

  outputDiv.textContent = "Processingâ€¦";

  try {
    const base64Image = await fileToBase64(file);
    const aiBase64 = await scanForText(base64Image); // returns base64
    displayBase64Text(aiBase64);
  } catch (err) {
    outputDiv.textContent = "Error: " + err;
  }
});
</script>
</body>
</html>
